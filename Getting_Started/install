import subprocess, os

def desktop():
    cwd = os.getcwd()
    save1 = cwd
    save2 = cwd+"/Desktop"
    F = open(save2+"/Alexander.desktop", 'w')
    Ins = ["[Desktop Entry]", "Type = Application", "Name = Alexander", "Encoding= UTF-8", "Exec = python3 "+cwd+"/Alex/Alexander.py", "Icon = "+cwd+"/Alex/Images/Logo.png", "StartupNotify = True"]
    F.writelines("%s\n" % i for i in Ins)
    F.close()
    subprocess.Popen("chmod +x "+save1+"/Desktop/Alexander.desktop", shell=True, stdout=subprocess.PIPE).stdout.read()

def pyinstall():
    subprocess.check_call(['apt', 'install', 'python3-pip'], user = "root")
    subprocess.check_call(['apt', 'install', 'python3-tk'], user = "root")
    subprocess.check_call(['apt', 'install', 'python3-vlc'], user = "root")
    subprocess.check_call(['pip3', 'install', 'googlesearch-python'])
    subprocess.check_call(['pip3', 'install', 'wikipedia'])
    subprocess.check_call(['pip3', 'install', 'speechrecognition'])
    subprocess.check_call(['pip3', 'install', 'pyttsx3'])
    subprocess.check_call(['pip3', 'install', 'gtts'])
    subprocess.check_call(['pip3', 'install', 'tk'])
    subprocess.check_call(['pip3', 'install', 'googletrans==3.1.0a0'])

if __name__ == "__main__":
    pyinstall()
    dsktp = input("Create Desktop Item?: [y/n] ")
    if dsktp == 'Y' or dsktp == 'y':
        desktop()
    else:
        pass
